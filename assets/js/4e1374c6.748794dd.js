"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[884],{6902:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>i,contentTitle:()=>c,default:()=>m,frontMatter:()=>o,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"orm/selector/select","title":"Select Build","description":"WebFrame ORM \u67e5\u8be2\u6784\u5efa\u7cfb\u7edf\u63d0\u4f9b\u4e86\u4e00\u79cd\u7c7b\u578b\u5b89\u5168\u3001\u7075\u6d3b\u4e14\u76f4\u89c2\u7684\u65b9\u5f0f\u6765\u6784\u5efa\u6570\u636e\u5e93\u67e5\u8be2\u3002","source":"@site/docs/orm/selector/select.md","sourceDirName":"orm/selector","slug":"/orm/selector/select","permalink":"/fyer-webframe/docs/orm/selector/select","draft":false,"unlisted":false,"editUrl":"https://github.com/fyerfyer/fyer-webframe/tree/main/docs/orm/selector/select.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Data Migration","permalink":"/fyer-webframe/docs/orm/migration/migrate"},"next":{"title":"Getting Started","permalink":"/fyer-webframe/docs/web/getting-started/started"}}');var s=n(4848),l=n(8453);const o={},c="Select Build",i={},a=[{value:"\u9009\u62e9\u5668",id:"\u9009\u62e9\u5668",level:2},{value:"\u521b\u5efa\u9009\u62e9\u5668",id:"\u521b\u5efa\u9009\u62e9\u5668",level:3},{value:"\u6307\u5b9a\u67e5\u8be2\u5217",id:"\u6307\u5b9a\u67e5\u8be2\u5217",level:3},{value:"\u522b\u540d\u652f\u6301",id:"\u522b\u540d\u652f\u6301",level:3},{value:"\u539f\u59cb SQL \u8868\u8fbe\u5f0f",id:"\u539f\u59cb-sql-\u8868\u8fbe\u5f0f",level:3},{value:"\u6267\u884c\u67e5\u8be2",id:"\u6267\u884c\u67e5\u8be2",level:3},{value:"\u5b50\u67e5\u8be2",id:"\u5b50\u67e5\u8be2",level:3},{value:"\u6761\u4ef6\u6784\u5efa",id:"\u6761\u4ef6\u6784\u5efa",level:2},{value:"\u57fa\u672c\u6bd4\u8f83\u64cd\u4f5c",id:"\u57fa\u672c\u6bd4\u8f83\u64cd\u4f5c",level:3},{value:"NULL \u503c\u68c0\u67e5",id:"null-\u503c\u68c0\u67e5",level:3},{value:"LIKE \u64cd\u4f5c\u7b26",id:"like-\u64cd\u4f5c\u7b26",level:3},{value:"IN \u64cd\u4f5c\u7b26",id:"in-\u64cd\u4f5c\u7b26",level:3},{value:"BETWEEN \u64cd\u4f5c\u7b26",id:"between-\u64cd\u4f5c\u7b26",level:3},{value:"\u903b\u8f91\u64cd\u4f5c\u7b26",id:"\u903b\u8f91\u64cd\u4f5c\u7b26",level:3},{value:"\u539f\u59cb SQL \u6761\u4ef6",id:"\u539f\u59cb-sql-\u6761\u4ef6",level:3},{value:"\u6392\u5e8f\u548c\u5206\u9875",id:"\u6392\u5e8f\u548c\u5206\u9875",level:2},{value:"\u6392\u5e8f",id:"\u6392\u5e8f",level:3},{value:"\u5206\u9875",id:"\u5206\u9875",level:3},{value:"\u5206\u9875\u52a9\u624b\u51fd\u6570",id:"\u5206\u9875\u52a9\u624b\u51fd\u6570",level:3},{value:"\u805a\u5408\u51fd\u6570",id:"\u805a\u5408\u51fd\u6570",level:2},{value:"\u57fa\u672c\u805a\u5408\u67e5\u8be2",id:"\u57fa\u672c\u805a\u5408\u67e5\u8be2",level:3},{value:"DISTINCT \u805a\u5408",id:"distinct-\u805a\u5408",level:3},{value:"\u591a\u805a\u5408\u67e5\u8be2",id:"\u591a\u805a\u5408\u67e5\u8be2",level:3},{value:"\u5206\u7ec4\u805a\u5408",id:"\u5206\u7ec4\u805a\u5408",level:3},{value:"\u805a\u5408\u8fc7\u6ee4",id:"\u805a\u5408\u8fc7\u6ee4",level:3},{value:"\u5b50\u67e5\u8be2\u4e2d\u7684\u805a\u5408",id:"\u5b50\u67e5\u8be2\u4e2d\u7684\u805a\u5408",level:3},{value:"\u7efc\u5408\u793a\u4f8b",id:"\u7efc\u5408\u793a\u4f8b",level:2}];function d(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"select-build",children:"Select Build"})}),"\n",(0,s.jsx)(r.p,{children:"WebFrame ORM \u67e5\u8be2\u6784\u5efa\u7cfb\u7edf\u63d0\u4f9b\u4e86\u4e00\u79cd\u7c7b\u578b\u5b89\u5168\u3001\u7075\u6d3b\u4e14\u76f4\u89c2\u7684\u65b9\u5f0f\u6765\u6784\u5efa\u6570\u636e\u5e93\u67e5\u8be2\u3002"}),"\n",(0,s.jsx)(r.h2,{id:"\u9009\u62e9\u5668",children:"\u9009\u62e9\u5668"}),"\n",(0,s.jsx)(r.p,{children:"\u9009\u62e9\u5668\uff08Selector\uff09\u662f WebFrame ORM \u4e2d\u7528\u4e8e\u6784\u5efa SELECT \u67e5\u8be2\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u5b83\u63d0\u4f9b\u4e86\u7c7b\u578b\u5b89\u5168\u7684 API \u7528\u4e8e\u6784\u5efa\u5404\u79cd\u6570\u636e\u5e93\u67e5\u8be2\u3002"}),"\n",(0,s.jsx)(r.h3,{id:"\u521b\u5efa\u9009\u62e9\u5668",children:"\u521b\u5efa\u9009\u62e9\u5668"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'import "github.com/fyerfyer/fyer-webframe/orm"\r\n\r\nfunc getAllUsers(ctx context.Context, db *orm.DB) ([]*User, error) {\r\n    // \u521b\u5efa\u4e00\u4e2a\u9009\u62e9\u5668\r\n    selector := orm.RegisterSelector[User](db)\r\n    \r\n    // \u6784\u5efa\u67e5\u8be2\r\n    users, err := selector.Select().GetMulti(ctx)\r\n    \r\n    return users, err\r\n}\n'})}),"\n",(0,s.jsx)(r.h3,{id:"\u6307\u5b9a\u67e5\u8be2\u5217",children:"\u6307\u5b9a\u67e5\u8be2\u5217"}),"\n",(0,s.jsxs)(r.p,{children:["\u53ef\u4ee5\u4f7f\u7528 ",(0,s.jsx)(r.code,{children:"Select"})," \u65b9\u6cd5\u6307\u5b9a\u8981\u67e5\u8be2\u7684\u7279\u5b9a\u5217\uff1a"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// \u67e5\u8be2\u6240\u6709\u5217 (SELECT * FROM users)\r\nselector := orm.RegisterSelector[User](db).Select()\r\n\r\n// \u67e5\u8be2\u7279\u5b9a\u5217 (SELECT id, name, email FROM users)\r\nselector := orm.RegisterSelector[User](db).Select(\r\n    orm.Col("ID"),\r\n    orm.Col("Name"),\r\n    orm.Col("Email"),\r\n)\n'})}),"\n",(0,s.jsx)(r.h3,{id:"\u522b\u540d\u652f\u6301",children:"\u522b\u540d\u652f\u6301"}),"\n",(0,s.jsx)(r.p,{children:"\u53ef\u4ee5\u4e3a\u5217\u548c\u8868\u8bbe\u7f6e\u522b\u540d\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// SELECT id AS user_id, name AS user_name FROM users\r\nselector := orm.RegisterSelector[User](db).Select(\r\n    orm.Col("ID").As("user_id"),\r\n    orm.Col("Name").As("user_name"),\r\n)\r\n\r\n// \u4f7f\u7528\u8868\u522b\u540d\r\nselector := orm.RegisterSelector[User](db).\r\n    From(orm.Table("users").As("u")).\r\n    Select(orm.Col("ID").As("user_id"))\n'})}),"\n",(0,s.jsx)(r.h3,{id:"\u539f\u59cb-sql-\u8868\u8fbe\u5f0f",children:"\u539f\u59cb SQL \u8868\u8fbe\u5f0f"}),"\n",(0,s.jsx)(r.p,{children:"\u652f\u6301\u539f\u59cb SQL \u8868\u8fbe\u5f0f\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:"// SELECT CONCAT(first_name, ' ', last_name) AS full_name FROM users\r\nselector := orm.RegisterSelector[User](db).Select(\r\n    orm.Raw(\"CONCAT(first_name, ' ', last_name) AS full_name\"),\r\n)\n"})}),"\n",(0,s.jsx)(r.h3,{id:"\u6267\u884c\u67e5\u8be2",children:"\u6267\u884c\u67e5\u8be2"}),"\n",(0,s.jsx)(r.p,{children:"\u9009\u62e9\u5668\u63d0\u4f9b\u4e86\u4e24\u79cd\u4e3b\u8981\u7684\u6267\u884c\u65b9\u6cd5\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:"// \u83b7\u53d6\u5355\u4e2a\u8bb0\u5f55\r\nuser, err := selector.Get(ctx)\r\n\r\n// \u83b7\u53d6\u591a\u6761\u8bb0\u5f55\r\nusers, err := selector.GetMulti(ctx)\n"})}),"\n",(0,s.jsx)(r.h3,{id:"\u5b50\u67e5\u8be2",children:"\u5b50\u67e5\u8be2"}),"\n",(0,s.jsx)(r.p,{children:"\u9009\u62e9\u5668\u53ef\u4ee5\u7528\u4f5c\u5b50\u67e5\u8be2\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// \u521b\u5efa\u5b50\u67e5\u8be2\r\nsubQuery := orm.RegisterSelector[User](db).\r\n    Select(orm.Col("DepartmentID")).\r\n    Where(orm.Col("Role").Eq("manager")).\r\n    AsSubQuery("manager_depts")\r\n\r\n// \u5728\u4e3b\u67e5\u8be2\u4e2d\u4f7f\u7528\r\nemployees := orm.RegisterSelector[Employee](db).\r\n    Select().\r\n    Where(orm.Col("DepartmentID").In(subQuery)).\r\n    GetMulti(ctx)\n'})}),"\n",(0,s.jsx)(r.h2,{id:"\u6761\u4ef6\u6784\u5efa",children:"\u6761\u4ef6\u6784\u5efa"}),"\n",(0,s.jsx)(r.p,{children:"WHERE \u6761\u4ef6\u662f\u67e5\u8be2\u7684\u5173\u952e\u90e8\u5206\uff0cWebFrame ORM \u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u6761\u4ef6\u6784\u5efa API\u3002"}),"\n",(0,s.jsx)(r.h3,{id:"\u57fa\u672c\u6bd4\u8f83\u64cd\u4f5c",children:"\u57fa\u672c\u6bd4\u8f83\u64cd\u4f5c"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// \u7b49\u4e8e (WHERE id = 1)\r\nselector := orm.RegisterSelector[User](db).Where(orm.Col("ID").Eq(1))\r\n\r\n// \u5927\u4e8e (WHERE age > 18)\r\nselector := orm.RegisterSelector[User](db).Where(orm.Col("Age").Gt(18))\r\n\r\n// \u5c0f\u4e8e (WHERE age < 30)\r\nselector := orm.RegisterSelector[User](db).Where(orm.Col("Age").Lt(30))\r\n\r\n// \u5927\u4e8e\u7b49\u4e8e (WHERE age >= 18)\r\nselector := orm.RegisterSelector[User](db).Where(orm.Col("Age").Gte(18))\r\n\r\n// \u5c0f\u4e8e\u7b49\u4e8e (WHERE age <= 65)\r\nselector := orm.RegisterSelector[User](db).Where(orm.Col("Age").Lte(65))\n'})}),"\n",(0,s.jsx)(r.h3,{id:"null-\u503c\u68c0\u67e5",children:"NULL \u503c\u68c0\u67e5"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// IS NULL (WHERE last_login IS NULL)\r\nselector := orm.RegisterSelector[User](db).Where(orm.Col("LastLogin").IsNull())\r\n\r\n// IS NOT NULL (WHERE email IS NOT NULL)\r\nselector := orm.RegisterSelector[User](db).Where(orm.Col("Email").NotNull())\n'})}),"\n",(0,s.jsx)(r.h3,{id:"like-\u64cd\u4f5c\u7b26",children:"LIKE \u64cd\u4f5c\u7b26"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// LIKE (WHERE name LIKE \'John%\')\r\nselector := orm.RegisterSelector[User](db).Where(orm.Col("Name").Like("John%"))\r\n\r\n// NOT LIKE (WHERE name NOT LIKE \'%test%\')\r\nselector := orm.RegisterSelector[User](db).Where(orm.Col("Name").NotLike("%test%"))\n'})}),"\n",(0,s.jsx)(r.h3,{id:"in-\u64cd\u4f5c\u7b26",children:"IN \u64cd\u4f5c\u7b26"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// IN (WHERE id IN (1, 2, 3))\r\nselector := orm.RegisterSelector[User](db).Where(orm.Col("ID").In(1, 2, 3))\r\n\r\n// NOT IN (WHERE status NOT IN (\'deleted\', \'banned\'))\r\nselector := orm.RegisterSelector[User](db).Where(orm.Col("Status").NotIn("deleted", "banned"))\n'})}),"\n",(0,s.jsx)(r.h3,{id:"between-\u64cd\u4f5c\u7b26",children:"BETWEEN \u64cd\u4f5c\u7b26"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:"// BETWEEN (WHERE age BETWEEN 18 AND 65)\r\nselector := orm.RegisterSelector[User](db).Where(orm.Col(\"Age\").Between(18, 65))\r\n\r\n// NOT BETWEEN (WHERE created_at NOT BETWEEN '2020-01-01' AND '2020-12-31')\r\nstartDate := time.Date(2020, 1, 1, 0, 0, 0, 0, time.UTC)\r\nendDate := time.Date(2020, 12, 31, 23, 59, 59, 0, time.UTC)\r\nselector := orm.RegisterSelector[User](db).Where(orm.Col(\"CreatedAt\").NotBetween(startDate, endDate))\n"})}),"\n",(0,s.jsx)(r.h3,{id:"\u903b\u8f91\u64cd\u4f5c\u7b26",children:"\u903b\u8f91\u64cd\u4f5c\u7b26"}),"\n",(0,s.jsx)(r.p,{children:"\u591a\u4e2a\u6761\u4ef6\u4f1a\u81ea\u52a8\u4f7f\u7528 AND \u8fde\u63a5\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// WHERE age > 18 AND status = \'active\'\r\nselector := orm.RegisterSelector[User](db).Where(\r\n    orm.Col("Age").Gt(18),\r\n    orm.Col("Status").Eq("active"),\r\n)\n'})}),"\n",(0,s.jsx)(r.p,{children:"\u4f7f\u7528 NOT \u64cd\u4f5c\u7b26\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// WHERE NOT (role = \'guest\')\r\nselector := orm.RegisterSelector[User](db).Where(\r\n    orm.NOT(orm.Col("Role").Eq("guest")),\r\n)\n'})}),"\n",(0,s.jsx)(r.h3,{id:"\u539f\u59cb-sql-\u6761\u4ef6",children:"\u539f\u59cb SQL \u6761\u4ef6"}),"\n",(0,s.jsx)(r.p,{children:"\u53ef\u4ee5\u4f7f\u7528\u539f\u59cb SQL \u6784\u5efa\u66f4\u590d\u6742\u7684\u6761\u4ef6\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// WHERE created_at > DATE_SUB(NOW(), INTERVAL 7 DAY)\r\nselector := orm.RegisterSelector[User](db).Where(\r\n    orm.Raw("created_at > DATE_SUB(NOW(), INTERVAL 7 DAY)"),\r\n)\n'})}),"\n",(0,s.jsx)(r.h2,{id:"\u6392\u5e8f\u548c\u5206\u9875",children:"\u6392\u5e8f\u548c\u5206\u9875"}),"\n",(0,s.jsx)(r.h3,{id:"\u6392\u5e8f",children:"\u6392\u5e8f"}),"\n",(0,s.jsxs)(r.p,{children:["\u4f7f\u7528 ",(0,s.jsx)(r.code,{children:"OrderBy"})," \u65b9\u6cd5\u5bf9\u7ed3\u679c\u8fdb\u884c\u6392\u5e8f\uff1a"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// \u5355\u5217\u5347\u5e8f\u6392\u5e8f (ORDER BY created_at ASC)\r\nselector := orm.RegisterSelector[User](db).\r\n    Select().\r\n    OrderBy(orm.Asc(orm.Col("CreatedAt")))\r\n\r\n// \u5355\u5217\u964d\u5e8f\u6392\u5e8f (ORDER BY created_at DESC)\r\nselector := orm.RegisterSelector[User](db).\r\n    Select().\r\n    OrderBy(orm.Desc(orm.Col("CreatedAt")))\r\n\r\n// \u591a\u5217\u6392\u5e8f (ORDER BY status ASC, created_at DESC)\r\nselector := orm.RegisterSelector[User](db).\r\n    Select().\r\n    OrderBy(\r\n        orm.Asc(orm.Col("Status")),\r\n        orm.Desc(orm.Col("CreatedAt")),\r\n    )\n'})}),"\n",(0,s.jsx)(r.h3,{id:"\u5206\u9875",children:"\u5206\u9875"}),"\n",(0,s.jsxs)(r.p,{children:["\u901a\u8fc7 ",(0,s.jsx)(r.code,{children:"Limit"})," \u548c ",(0,s.jsx)(r.code,{children:"Offset"})," \u65b9\u6cd5\u5b9e\u73b0\u5206\u9875\uff1a"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:"// \u9650\u5236\u8fd4\u56de\u7684\u884c\u6570 (LIMIT 10)\r\nselector := orm.RegisterSelector[User](db).\r\n    Select().\r\n    Limit(10)\r\n\r\n// \u8bbe\u7f6e\u504f\u79fb\u91cf (OFFSET 20)\r\nselector := orm.RegisterSelector[User](db).\r\n    Select().\r\n    Offset(20)\r\n\r\n// \u7ec4\u5408\u4f7f\u7528\u5b9e\u73b0\u5206\u9875 (LIMIT 10 OFFSET 20)\r\nselector := orm.RegisterSelector[User](db).\r\n    Select().\r\n    Limit(10).\r\n    Offset(20)\n"})}),"\n",(0,s.jsx)(r.h3,{id:"\u5206\u9875\u52a9\u624b\u51fd\u6570",children:"\u5206\u9875\u52a9\u624b\u51fd\u6570"}),"\n",(0,s.jsx)(r.p,{children:"\u5b9e\u73b0\u5206\u9875\u67e5\u8be2\u7684\u8f85\u52a9\u51fd\u6570\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'func paginate[T any](ctx context.Context, db *orm.DB, page, pageSize int, where ...orm.Condition) ([]*T, int64, error) {\r\n    // \u521b\u5efa\u9009\u62e9\u5668\r\n    selector := orm.RegisterSelector[T](db)\r\n    \r\n    // \u8ba1\u7b97\u603b\u8bb0\u5f55\u6570\r\n    countSelector := orm.RegisterSelector[T](db)\r\n    countResult, err := countSelector.\r\n        Select(orm.Count("*").As("count")).\r\n        Where(where...).\r\n        Get(ctx)\r\n    if err != nil {\r\n        return nil, 0, err\r\n    }\r\n    \r\n    // \u83b7\u53d6\u5206\u9875\u6570\u636e\r\n    offset := (page - 1) * pageSize\r\n    items, err := selector.\r\n        Select().\r\n        Where(where...).\r\n        OrderBy(orm.Desc(orm.Col("CreatedAt"))).\r\n        Limit(pageSize).\r\n        Offset(offset).\r\n        GetMulti(ctx)\r\n    \r\n    if err != nil {\r\n        return nil, 0, err\r\n    }\r\n    \r\n    // \u4ece\u8ba1\u6570\u67e5\u8be2\u4e2d\u63d0\u53d6\u603b\u6570\r\n    total := countResult.Count\r\n    \r\n    return items, total, nil\r\n}\n'})}),"\n",(0,s.jsx)(r.p,{children:"\u4f7f\u7528\u5206\u9875\u51fd\u6570\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// \u83b7\u53d6\u7b2c2\u9875\uff0c\u6bcf\u987510\u6761\u6570\u636e\r\nusers, total, err := paginate[User](ctx, db, 2, 10, orm.Col("Status").Eq("active"))\n'})}),"\n",(0,s.jsx)(r.h2,{id:"\u805a\u5408\u51fd\u6570",children:"\u805a\u5408\u51fd\u6570"}),"\n",(0,s.jsx)(r.p,{children:"WebFrame ORM \u652f\u6301\u5404\u79cd\u805a\u5408\u51fd\u6570\uff0c\u5982 COUNT\u3001SUM\u3001AVG\u3001MAX \u548c MIN\u3002"}),"\n",(0,s.jsx)(r.h3,{id:"\u57fa\u672c\u805a\u5408\u67e5\u8be2",children:"\u57fa\u672c\u805a\u5408\u67e5\u8be2"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// COUNT - \u8ba1\u7b97\u7528\u6237\u603b\u6570\r\ncountResult, err := orm.RegisterSelector[User](db).\r\n    Select(orm.Count("*").As("total")).\r\n    Get(ctx)\r\n\r\n// SUM - \u8ba1\u7b97\u603b\u5e74\u9f84\r\nsumResult, err := orm.RegisterSelector[User](db).\r\n    Select(orm.Sum("Age").As("total_age")).\r\n    Get(ctx)\r\n\r\n// AVG - \u8ba1\u7b97\u5e73\u5747\u5e74\u9f84\r\navgResult, err := orm.RegisterSelector[User](db).\r\n    Select(orm.Avg("Age").As("avg_age")).\r\n    Get(ctx)\r\n\r\n// MAX - \u67e5\u627e\u6700\u5927\u5e74\u9f84\r\nmaxResult, err := orm.RegisterSelector[User](db).\r\n    Select(orm.Max("Age").As("max_age")).\r\n    Get(ctx)\r\n\r\n// MIN - \u67e5\u627e\u6700\u5c0f\u5e74\u9f84\r\nminResult, err := orm.RegisterSelector[User](db).\r\n    Select(orm.Min("Age").As("min_age")).\r\n    Get(ctx)\n'})}),"\n",(0,s.jsx)(r.h3,{id:"distinct-\u805a\u5408",children:"DISTINCT \u805a\u5408"}),"\n",(0,s.jsx)(r.p,{children:"\u4f7f\u7528 DISTINCT \u5173\u952e\u5b57\u8fdb\u884c\u805a\u5408\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// COUNT DISTINCT - \u8ba1\u7b97\u4e0d\u91cd\u590d\u7684\u90e8\u95e8\u6570\u91cf\r\ncountDistinctResult, err := orm.RegisterSelector[User](db).\r\n    Select(orm.CountDistinct("DepartmentID").As("dept_count")).\r\n    Get(ctx)\n'})}),"\n",(0,s.jsx)(r.h3,{id:"\u591a\u805a\u5408\u67e5\u8be2",children:"\u591a\u805a\u5408\u67e5\u8be2"}),"\n",(0,s.jsx)(r.p,{children:"\u5728\u540c\u4e00\u67e5\u8be2\u4e2d\u4f7f\u7528\u591a\u4e2a\u805a\u5408\u51fd\u6570\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// \u540c\u65f6\u83b7\u53d6\u591a\u4e2a\u7edf\u8ba1\u6570\u636e\r\nstatsResult, err := orm.RegisterSelector[User](db).\r\n    Select(\r\n        orm.Count("*").As("total_users"),\r\n        orm.Avg("Age").As("avg_age"),\r\n        orm.Min("Age").As("min_age"),\r\n        orm.Max("Age").As("max_age"),\r\n    ).\r\n    Get(ctx)\r\n\r\n// \u8bbf\u95ee\u7ed3\u679c\r\ntotalUsers := statsResult.TotalUsers\r\navgAge := statsResult.AvgAge\r\nminAge := statsResult.MinAge\r\nmaxAge := statsResult.MaxAge\n'})}),"\n",(0,s.jsx)(r.h3,{id:"\u5206\u7ec4\u805a\u5408",children:"\u5206\u7ec4\u805a\u5408"}),"\n",(0,s.jsxs)(r.p,{children:["\u4f7f\u7528 ",(0,s.jsx)(r.code,{children:"GroupBy"})," \u8fdb\u884c\u5206\u7ec4\u805a\u5408\u67e5\u8be2\uff1a"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// \u6309\u90e8\u95e8\u7edf\u8ba1\u7528\u6237\u6570\u91cf\r\ndeptStats, err := orm.RegisterSelector[User](db).\r\n    Select(\r\n        orm.Col("DepartmentID"),\r\n        orm.Count("*").As("user_count"),\r\n        orm.Avg("Age").As("avg_age"),\r\n    ).\r\n    GroupBy(orm.Col("DepartmentID")).\r\n    GetMulti(ctx)\n'})}),"\n",(0,s.jsx)(r.h3,{id:"\u805a\u5408\u8fc7\u6ee4",children:"\u805a\u5408\u8fc7\u6ee4"}),"\n",(0,s.jsxs)(r.p,{children:["\u4f7f\u7528 ",(0,s.jsx)(r.code,{children:"Having"})," \u8fc7\u6ee4\u805a\u5408\u7ed3\u679c\uff1a"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// \u67e5\u627e\u7528\u6237\u6570\u91cf\u5927\u4e8e5\u7684\u90e8\u95e8\r\nlargeDepts, err := orm.RegisterSelector[User](db).\r\n    Select(\r\n        orm.Col("DepartmentID"),\r\n        orm.Count("*").As("user_count"),\r\n    ).\r\n    GroupBy(orm.Col("DepartmentID")).\r\n    Having(orm.Col("user_count").Gt(5)).\r\n    GetMulti(ctx)\n'})}),"\n",(0,s.jsx)(r.h3,{id:"\u5b50\u67e5\u8be2\u4e2d\u7684\u805a\u5408",children:"\u5b50\u67e5\u8be2\u4e2d\u7684\u805a\u5408"}),"\n",(0,s.jsx)(r.p,{children:"\u5728\u5b50\u67e5\u8be2\u4e2d\u4f7f\u7528\u805a\u5408\u51fd\u6570\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'// \u67e5\u627e\u7528\u6237\u6570\u91cf\u9ad8\u4e8e\u5e73\u5747\u503c\u7684\u90e8\u95e8\r\navgUserCountQuery := orm.RegisterSelector[User](db).\r\n    Select(orm.Avg(orm.Count("*")).As("avg_count")).\r\n    GroupBy(orm.Col("DepartmentID")).\r\n    AsSubQuery("avg_stats")\r\n\r\ndepts, err := orm.RegisterSelector[Department](db).\r\n    Select().\r\n    Join(orm.InnerJoin, avgUserCountQuery).\r\n    Where(orm.Col("user_count").Gt(orm.Col("avg_stats.avg_count"))).\r\n    GetMulti(ctx)\n'})}),"\n",(0,s.jsx)(r.h2,{id:"\u7efc\u5408\u793a\u4f8b",children:"\u7efc\u5408\u793a\u4f8b"}),"\n",(0,s.jsx)(r.p,{children:"\u4e0b\u9762\u662f\u4e00\u4e2a\u7efc\u5408\u793a\u4f8b\uff0c\u5c55\u793a\u4e86\u5982\u4f55\u7ed3\u5408\u4f7f\u7528\u9009\u62e9\u5668\u3001\u6761\u4ef6\u6784\u5efa\u3001\u6392\u5e8f\u5206\u9875\u548c\u805a\u5408\u51fd\u6570\uff1a"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-go",children:'package main\r\n\r\nimport (\r\n    "context"\r\n    "fmt"\r\n    "time"\r\n    \r\n    "github.com/fyerfyer/fyer-webframe/orm"\r\n)\r\n\r\n// User \u7528\u6237\u6a21\u578b\r\ntype User struct {\r\n    ID           int64\r\n    Name         string\r\n    Age          int\r\n    Email        string\r\n    DepartmentID int64\r\n    Status       string\r\n    CreatedAt    time.Time\r\n    UpdatedAt    time.Time\r\n}\r\n\r\nfunc main() {\r\n    // \u8fde\u63a5\u6570\u636e\u5e93\r\n    db, err := orm.OpenDB("mysql", "user:password@tcp(localhost:3306)/testdb", "mysql")\r\n    if err != nil {\r\n        panic(err)\r\n    }\r\n    defer db.Close()\r\n    \r\n    ctx := context.Background()\r\n    \r\n    // \u590d\u6742\u67e5\u8be2\u793a\u4f8b\uff1a\r\n    // \u67e5\u627e\u6d3b\u8dc3\u90e8\u95e8\u4e2d\u5e74\u9f84\u8d85\u8fc7\u5e73\u5747\u5e74\u9f84\u7684\u7528\u6237\r\n    // \u6309\u521b\u5efa\u65f6\u95f4\u964d\u5e8f\u6392\u5217\uff0c\u5e76\u5206\u9875\u663e\u793a\r\n    \r\n    // 1. \u9996\u5148\u67e5\u8be2\u5e73\u5747\u5e74\u9f84\r\n    avgAgeResult, err := orm.RegisterSelector[User](db).\r\n        Select(orm.Avg("Age").As("avg_age")).\r\n        Get(ctx)\r\n    if err != nil {\r\n        panic(err)\r\n    }\r\n    avgAge := avgAgeResult.AvgAge\r\n    \r\n    // 2. \u67e5\u8be2\u6d3b\u8dc3\u90e8\u95e8ID (\u5047\u8bbe\u6709\u4e00\u4e2a\u6d3b\u8dc3\u90e8\u95e8\u7684\u9608\u503c)\r\n    activeDeptQuery := orm.RegisterSelector[User](db).\r\n        Select(\r\n            orm.Col("DepartmentID"),\r\n            orm.Count("*").As("user_count"),\r\n        ).\r\n        GroupBy(orm.Col("DepartmentID")).\r\n        Having(orm.Col("user_count").Gt(5)).\r\n        AsSubQuery("active_depts")\r\n    \r\n    // 3. \u4e3b\u67e5\u8be2\uff1a\u67e5\u627e\u6d3b\u8dc3\u90e8\u95e8\u4e2d\u5e74\u9f84\u8d85\u8fc7\u5e73\u5747\u5e74\u9f84\u7684\u7528\u6237\r\n    page := 1\r\n    pageSize := 10\r\n    offset := (page - 1) * pageSize\r\n    \r\n    users, err := orm.RegisterSelector[User](db).\r\n        Select().\r\n        Where(\r\n            orm.Col("Age").Gt(avgAge),\r\n            orm.Col("Status").Eq("active"),\r\n            orm.Col("DepartmentID").In(activeDeptQuery),\r\n        ).\r\n        OrderBy(orm.Desc(orm.Col("CreatedAt"))).\r\n        Limit(pageSize).\r\n        Offset(offset).\r\n        GetMulti(ctx)\r\n    \r\n    if err != nil {\r\n        panic(err)\r\n    }\r\n    \r\n    // \u5904\u7406\u7ed3\u679c\r\n    for _, user := range users {\r\n        fmt.Printf("ID: %d, Name: %s, Age: %d\\n", user.ID, user.Name, user.Age)\r\n    }\r\n}\n'})})]})}function m(e={}){const{wrapper:r}={...(0,l.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>c});var t=n(6540);const s={},l=t.createContext(s);function o(e){const r=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(l.Provider,{value:r},e.children)}}}]);